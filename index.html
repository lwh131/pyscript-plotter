<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PyScript Sine Wave Plotter</title>
    <!-- PyScript version-pinned CDN -->
    <link rel="stylesheet" href="https://pyscript.net/releases/2025.8.1/core.css">
    <script type="module" src="https://pyscript.net/releases/2025.8.1/core.js"></script>
</head>
<body>
    <h1>ðŸ§  PyScript Sine Wave Plotter</h1>
    <p>Enter the parameters below to generate your sine wave plot.</p>

    <div>
        <label for="amplitude">Amplitude:</label>
        <input type="number" id="amplitude" value="1" step="0.1"><br><br>

        <label for="frequency">Frequency:</label>
        <input type="number" id="frequency" value="1" step="0.1"><br><br>

        <label for="phase">Phase Shift (radians):</label>
        <input type="number" id="phase" value="0" step="0.1"><br><br>

        <button id="plot-button">Generate Plot</button>
    </div>

    <hr>

    <div id="plot-container"></div>

    <!-- PyScript config to load required Python packages -->
    <py-config>
        packages = ["numpy", "matplotlib"]
    </py-config>

    <!-- PyScript inline Python code -->
    <py-script>
        from pyodide.ffi import create_proxy
        from pyscript import document
        import numpy as np
        import matplotlib.pyplot as plt
        import pyscript

        def plot_sine_wave(event):
            # Read values from the input fields
            amplitude = float(document.getElementById("amplitude").value)
            frequency = float(document.getElementById("frequency").value)
            phase = float(document.getElementById("phase").value)

            # Generate data for the sine wave
            x = np.linspace(0, 2 * np.pi, 400)
            y = amplitude * np.sin(frequency * x + phase)

            # Create the plot
            fig, ax = plt.subplots()
            ax.plot(x, y, label=f"A={amplitude}, f={frequency}, phase={phase}")
            ax.set_xlabel("x")
            ax.set_ylabel("y")
            ax.set_title("Sine Wave")
            ax.legend()

            # Clear previous plot
            plot_container = document.getElementById("plot-container")
            plot_container.innerHTML = ""

            # Display the matplotlib figure in the container
            pyscript.display(fig, target="plot-container")

        # âœ… Create a proxy to persist the callback reference
        plot_callback = create_proxy(plot_sine_wave)

        # âœ… Attach event listener safely
        button = document.getElementById("plot-button")
        button.addEventListener("click", plot_callback)

    </py-script>

</body>
</html>
